# IPCrawler Tool Defaults Database
# Default configurations and common patterns for security tools

tool_defaults:
  # Common security tool categories
  categories:
    port_scanners:
      description: "Network port scanning tools"
      common_outputs: ["json", "xml", "text"]
      typical_args: ["-target", "--output", "--format"]
      examples: ["naabu", "masscan", "zmap"]
      
    dns_tools:
      description: "DNS enumeration and analysis tools"
      common_outputs: ["text", "json"]
      typical_args: ["target", "record_type"]
      examples: ["dig", "host", "nslookup"]
      
    web_scanners:
      description: "Web application security scanners"
      common_outputs: ["json", "xml", "html"]
      typical_args: ["-u", "--url", "-o", "--output"]
      examples: ["ffuf", "gobuster", "dirb"]
      
    service_detection:
      description: "Service fingerprinting and detection"
      common_outputs: ["xml", "json", "text"]
      typical_args: ["-sV", "--service-detection", "-oX"]
      examples: ["nmap", "ncat", "telnet"]
      
  # Common flag patterns across tools
  common_flags:
    output_formats:
      json: ["-oJ", "--json", "-f json", "--format=json"]
      xml: ["-oX", "--xml", "-f xml", "--format=xml"]
      text: ["-oN", "--text", "-f text", "--format=text"]
      
    verbosity:
      quiet: ["-q", "--quiet", "--silent"]
      verbose: ["-v", "--verbose"]
      debug: ["-d", "--debug", "-vv"]
      
    performance:
      fast: ["--fast", "-T4", "--speed=fast"]
      slow: ["--slow", "-T1", "--speed=slow"]
      aggressive: ["-T5", "--aggressive"]
      
    network:
      threads: ["-t", "--threads", "--parallel"]
      timeout: ["--timeout", "-W", "--wait"]
      rate_limit: ["--rate", "--limit", "--delay"]
      
  # Default argument patterns
  argument_patterns:
    target_placeholder: "{{target}}"
    output_placeholder: "{{output}}"
    config_placeholder: "{{config}}"
    
    common_replacements:
      target_domain: "{{target}}"
      target_ip: "{{target_ip}}"
      output_file: "{{output_file}}"
      output_dir: "{{output_dir}}"
      tool_config: "{{tool_config}}"
      
  # Security considerations for tool execution
  security:
    allowed_commands:
      # Only allow specific security tools
      whitelist: ["naabu", "dig", "nmap", "ffuf", "gobuster", "nslookup"]
      
    forbidden_patterns:
      # Prevent dangerous command injection
      blacklist: ["rm", "del", "format", "mkfs", "dd", ">/dev/", "sudo", "su"]
      
    argument_validation:
      max_length: 5000
      forbidden_chars: [";", "|", "&", "`", "$()"]
      
    file_operations:
      allowed_extensions: [".txt", ".json", ".xml", ".csv", ".log"]
      max_file_size: "100MB"
      output_directory_only: true
      
  # Tool execution defaults
  execution:
    default_timeout: 300  # 5 minutes
    max_retries: 2
    retry_delay: 5
    
    environment:
      clear_env: false
      preserve_vars: ["PATH", "HOME", "USER"]
      
    resource_limits:
      max_memory: "512MB"
      max_cpu_time: "600s"  # 10 minutes
      
  # Error code interpretations
  exit_codes:
    success: [0]
    partial_success: [1, 2]  # Tool completed but with warnings
    failure: [3, 4, 5]       # Tool failed to execute properly
    timeout: [124, 137]      # Process timeout or kill
    
  # Output validation patterns
  output_validation:
    json:
      required_fields: []
      max_nesting_depth: 10
      
    xml:
      require_root_element: true
      max_file_size: "50MB"
      
    text:
      max_lines: 100000
      encoding: "utf-8"