name: "Port Discovery Scan"
description: "Fast port discovery scan to identify open ports"
provides:
  - "discovered_ports"
report:
  enabled: true
  agents:
    - receiver
    - nmap_processor
    - validator
    - reporter
  coordination: true
steps:
  - tool: "nmap"
    args:
      - "-sT"              # TCP connect scan (no root required)
      - "-Pn"              # Treat all hosts as online
      - "-T4"              # Aggressive timing
      - "--top-ports"      # Scan top ports
      - "1000"             # Scan top 1000 ports
      - "--open"           # Only show open ports
      - "-oN"              # Normal output format
      - "{{report_dir}}/raw/nmap_port_discovery_{{target}}.txt"
      - "-oX"              # XML output for parsing
      - "{{report_dir}}/raw/nmap_port_discovery_{{target}}.xml"
      - "{{target}}"       # Target to scan