id: dns_lookup
description: Basic DNS resolution and record lookup
parallel: true
continue_on_error: true
execution:
  timeout_seconds: 120  # 2 minutes for DNS resolution
  max_concurrent_steps: 4
  retry_count: 1
  failure_strategy: "continue"
steps:
  - id: resolve_a
    tool: dig
    override_args:
      - "{{target}}"
      - "A"
      - "+short"
    output: "out/{{target}}/dns_a.txt"
  - id: resolve_ns
    tool: nslookup
    use_flags: ns_lookup
    optional: true
    override_args:
      - "{{target}}"
    output: "out/{{target}}/dns_ns.txt"
  - id: resolve_mx
    tool: nslookup
    use_flags: mx_lookup
    optional: true
    override_args:
      - "{{target}}"
    output: "out/{{target}}/dns_mx.txt"
  - id: resolve_txt
    tool: nslookup
    use_flags: txt_lookup
    optional: true
    override_args:
      - "{{target}}"
    output: "out/{{target}}/dns_txt.txt"