name: "Enhanced Reconnaissance"
description: "Multi-mode parallel port discovery and comprehensive service enumeration"
category: "reconnaissance"

# Enhanced workflow-level parallelism controls
parallel_workflow: true        # Can run simultaneously with other workflows (like DNS)
independent_execution: false   # Needs internal step dependencies (nmap waits for naabu)
max_concurrent_workflows: 2    # Limit parallel workflows
workflow_priority: "medium"    # Medium priority execution

steps:
  - name: "Multi-Mode Port Discovery"
    tool: "naabu"
    description: "Parallel execution of multiple naabu scan modes for comprehensive coverage"
    modes: ["fast_scan"]
    concurrent: true               # Run all modes in parallel
    combine_results: true          # Combine results from all modes
    
    # Enhanced step-level parallelism controls
    step_priority: "high"          # High priority for port discovery
    max_concurrent_tools: 1       # Run up to 2 naabu instances simultaneously
    
    outputs:
      variables:
        - name: "combined_naabu_ports"
          source: "combined_ports"     # Extract from combined results
        - name: "combined_port_count"
          source: "combined_port_count"
        - name: "high_coverage_ports"
          source: "combined_high_coverage_ports"  # Ports found by multiple modes
  
  - name: "Multi-Mode Service Analysis"
    tool: "nmap"
    description: "Parallel service analysis with multiple scan techniques"
    modes: ["pipeline_service_scan"]
    concurrent: false
    combine_results: true
    depends_on: "Multi-Mode Port Discovery"
    
    # Enhanced step-level parallelism controls
    step_priority: "medium"        # Medium priority for service analysis
    max_concurrent_tools: 1        # Single nmap instance (resource intensive)
    
    inputs:
      variables:
        - name: "combined_naabu_ports"
          target_variable: "ports"  # Maps combined ports to {{ports}} variable
